# Hypridle - Configuração Corrigida

general {
    lock_cmd = hyprlock                      # Comando para bloquear
    unlock_cmd = killall -q -s SIGUSR1 hyprlock
    before_sleep_cmd = hyprlock              # Bloqueia antes de suspender
    ignore_dbus_inhibit = false
}

# 1. Suspender ao fechar a tampa (se estiver na bateria)
listener {
    timeout = 10
    on-timeout = ~/.config/hypr/scripts/check_suspend.sh
}

# 2. Bloquear a tela após 5 minutos de inatividade
listener {
    timeout = 300
    on-timeout = loginctl lock-session       # Forma mais limpa de chamar o lock_cmd
}

# 3. Desligar o monitor 5 segundos após bloquear
listener {
    timeout = 305
    on-timeout = hyprctl dispatch dpms off
    on-resume = hyprctl dispatch dpms on
}

# 4. Suspender após 7 minutos de inatividade (apenas se estiver descarregando)
listener {
    timeout = 420
    on-timeout = if cat /sys/class/power_supply/BAT0/status | grep -q 'Discharging'; then systemctl suspend; fi
}
